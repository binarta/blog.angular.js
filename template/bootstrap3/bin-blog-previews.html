<div class="container bin-blog bin-blog-previews"
     ng-controller="BinartaSearchController"
     ng-init="init({
                entity:'catalog-item',
                context:'search',
                filters:{
                    type:'blog',
                    blogType: settings.blogType,
                    status:'published',
                    sortings: [
                        {on:'creationTime', orientation:'desc'}
                    ]
                },
                autosearch:true,
                subset:{count:5}})">
    <div checkpoint-permission-for="catalog.item.add">
        <div class="row" ng-if="permitted">
            <div class="col-sm-8 col-sm-offset-4">
                <div class="bin-add-article-button-wrapper" i18n code="blog.article.add.new.button" default="Add new article" read-only>
                    <a class="btn btn-primary bin-add-article-button" ng-href="#!{{localePrefix}}/blog/add">
                        <i class="fa fa-plus fa-fw"></i> {{var}}
                    </a>
                </div>
                <hr>
            </div>
        </div>
    </div>

    <article class="row bin-article" ng-repeat="item in results track by item.id" i18n code="{{item.id}}.body" var="body" read-only>
        <div class="col-sm-4">
            <div class="bin-article-image-wrapper" checkpoint-permission-for="edit.mode">
                <span ng-if="body != '' || permitted">
                    <a ng-href="#!{{localePrefix}}/view{{item.id}}">
                        <img class="img-responsive" bin-image="images{{item.id}}/cover.img" alt="blog post cover image">
                    </a>
                </span>
                <span ng-if="body == '' && !permitted">
                    <img class="img-responsive" bin-image="images{{item.id}}/cover.img" alt="blog post cover image">
                </span>
            </div>
        </div>
        <div class="col-sm-8">
            <div class="well clearfix">
                <div class="row">
                    <div class="col-sm-12">
                        <h2 class="inline bin-article-title" i18n code="{{item.id}}" default="{{item.id}}"
                            checkpoint-permission-for="edit.mode">
                            <a ng-href="#!{{localePrefix}}/view{{item.id}}" ng-if="body != '' || permitted">{{var}}</a>
                            <span ng-if="body == '' && !permitted">{{var}}</span>
                        </h2>
                        <ul class="list-inline">
                            <li>
                                <i class="fa fa-clock-o fa-fw"></i>
                                {{item.creationTime | amDateFormat:'MMMM DD, YYYY'}}
                            </li>
                            <li ng-if="settings.useBlogTypes">
                                <i class="fa fa-tag fa-fw"></i>
                                <i18n class="inline" code="blog.type.{{item.blogType}}" default="{{item.blogType}}">{{var}}</i18n>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <p class="bin-article-lead" i18n code="{{item.id}}.lead" editor="full" ng-bind-html="var|trust"></p>

            <span class="inline" i18n code="blog.read.more" default="Read More..." ng-if="body != ''">
                <a ng-href="#!{{localePrefix}}/view{{item.id}}" class="read-more" title="Read More">
                    {{var}}
                </a>
            </span>
        </div>
        <div class="col-sm-8 col-sm-offset-4">
            <hr>
        </div>
    </article>

    <div class="row" ng-if="results.length == 0 && !working">
        <div class="col-xs-12 text-center">
            <p i18n code="blog.no.articles.found" default="No articles found...">{{var}}</p>
        </div>
    </div>

    <div class="row" ng-if="results.length >= 5">
        <div class="col-sm-8 col-sm-offset-4">
            <hr>
            <i18n class="inline" code="button.view.older.articles" default="View older articles">
                <button type="button" class="btn btn-primary" ng-click="searchForMore()" ng-disabled="working"
                        in-view="$inview ? searchForMore() : $inview">
                    <span ng-if="!working"><i class="fa fa-arrow-circle-o-down fa-fw"></i></span>
                    <span ng-if="working"><i class="fa fa-spinner fa-spin fa-fw"></i></span>
                    {{var}}
                </button>
            </i18n>
        </div>
    </div>
</div>